{# templates/event/editone.html.twig #}

{% extends 'admin.html.twig' %}

{% block stylesheets %}
      {{ parent() }}
   <link href="{{ asset('event_css/editone.css') }}" rel="stylesheet" />
 {% endblock %}

 {% block js %}
 {{ parent() }}
 <script>
    
     function clicklocation(lid)
     {
      window.location.href = '/admin/event/setlocation/{{objid}}/'+lid;
     }
     
     function clickimage(iid)
     {
        window.location.href = '/admin/event/addimage/{{objid}}/'+iid;
     }
     
     function clickperson(pid)
     {
        window.location.href = '/admin/event/addparticipant/{{objid}}/'+pid;
     }
     
     function clickcontent(cid)
     {
        window.location.href = '/admin/event/addcontent/{{objid}}/'+cid;
     }
     
   </script>
{% endblock %}


{% block middle %}
  <div id="editevent">
   {% if message %}
     <h1> {{message}}</h1>
   {% endif %}

   {% if event is defined %}
   {% if event.ancestors %}
       {% set ancestors = event.ancestors %}
        <div  class="breadcrumbs">
          {% for key in ancestors | keys %}
           => <a href='{{ancestors[key].link}}' >{{ancestors[key].title}} </a> 
          {% endfor %}
        </div>
   {% endif %} 
  
   <div class="heading">
     <div class="label"> {{'event.a.editer' | trans}}</div>
     <div class='title' >{{ event.title}}</div>
     <div class="editbutton" ><a href="/admin/event/detail/{{event.eventid}}"> {{"edit.event.detail" | trans }} </a></div>
     <div class="editbutton" ><a href="/admin/event/addbookmark/{{event.eventid}}"> {{"bookmark.event" | trans }} </a></div>
     <div class="returnbutton" ><a href="{{returnlink}}"> {{"retour" | trans }} </a></div>
   </div>
   
   {% if ( event.startdate is defined ) or (event.enddate is defined )%}
     <div class="dates" > {{ event.startdate}} : {{ event.enddate}} </div>
   {% endif %}
   
     {% if event.locid %}
      <div class="location heading" > 
      <div class="label" >{% trans %} Endroit {% endtrans %} :</div>
      <div ><a href ="{{ event.location['link'] }}"> {{ event.location['name'] }}</a> </div>
      </div>
     {% endif %}
     
     {% if images %}
     <div class="imagegroup" >
            <div class="images">
                {% for image in images %}
                <div class="image">
                    <div class="imageimage" ><a href="{{image.link}}" ><img src="{{image.fullpath}}" /></a></div>
                    <div class="imagedelete deletebutton" ><a href="/admin/event/removeimage/{{event.eventid}}/{{image.refid}}">{%trans%}delete{%endtrans%}</a></div>
                </div>
                {% endfor %}
             </div>
      </div>
      {% endif %}      
            
     <div class="refgroup" >
     <div class="header">
     <div class="label"> {{'liens' | trans}}</div>
     <div class="editbutton" ><a href="/admin/linkref/editevent/{{event.eventid}}">{{'edit.refs' | trans }}</a></div>
     </div>
    {% for ref in refs %}
     <div class="ref">
      <div class="refref" ><a href="{{ref.link}}">{{ref.label}}</a></div>
    </div>
    {% endfor %}
    </div>
 
           {% if text or title %}
           <div class="textpanel" >
                <div class="edit editbutton">
                   <a href = "/admin/text/event/{{objid}}"   > {%trans%}edit.text{% endtrans %}</a>
                </div>
                <div class="texts">
                  <div class="title" >
                    {{ title| raw }}
                </div>
                <div class="text" >
                    {{ text | raw }}
                </div>
                </div>
            </div>
        {%else%}
            <div  class="notext" >
                <span class="label" > {% trans %} no.text {% endtrans %} </span>
                <a href = "/admin/text/event/{{objid}}" class="editbutton"  > {%trans%}add.text{% endtrans %}</a>
            </div>
        {% endif %}
   
   
     
   {% if participants %}
   <div class="hidebar" > <button onclick="HideMe('pdiv' )">{{'participants' |trans}}</button></div>
    <div id="pdiv" class=participants>
        {% for  key in participants | keys %}
         <div class=participant > <a href='{{participants[key].link}}' >{{participants[key].label}}</a>  </div>
        {% endfor %}
        </div>
    {% endif %}
    
    <div class="hidebar" > <button onclick="HideMe2('pdiv2' )">{{'sous.evenments' | trans }}</button></div>
  
    <div id="pdiv2" class="children">
    <div class= "subheading" >
      <div class="label"> {{'children'|trans}}</div>
      <div class="editbutton" >  <a href="/admin/event/detail/-{{event.eventid}}"> {{"edit.event.new" | trans }} </a></div>
    </div>
      {% if event.children %}
      {% set children = event.children %}
      <div class='children' >       
        {% for key in children | keys %}
          <div class="child" >
          <a href='{{children[key]["link"]}}' > {{children[key]['title']}}</a>
          <div class="dates" >{{ children[key]['fstartdate'] }}</div> 
          </div>
        {% endfor %}
      </div>
    {% endif %} 
    </div>
  {% endif %}
  </div>
{% endblock %}

{% block right %}

   {{ render(controller('AppBundle\\Controller\\BookmarksController::setfield'))}}

{% endblock%}
